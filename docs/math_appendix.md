# –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
---
    
## 1. –û–±–æ–∑–Ω–∞—á–µ–Ω–∏—è –∏ –Ω–æ—Ç–∞—Ü–∏—è.  
  
- U - –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, I - –º–Ω–æ–∂–µ—Å—Ç–≤–æ items, |U|, |I| - –∏—Ö —Ä–∞–∑–º–µ—Ä—ã.
- $R\in\mathbb{R}^{|U|\times|I|}$ - –º–∞—Ç—Ä–∏—Ü–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π;
- $\mathcal{O}=\{(u,i)\}$ - –Ω–∞–±–æ—Ä –Ω–∞–±–ª—é–¥–µ–Ω–∏–π.
- $\mathbf{u}_u\in\mathbb{R}^d$ - –ª–∞—Ç–µ–Ω—Ç–Ω—ã–π –≤–µ–∫—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è u;
- $\mathbf{v}_i\in\mathbb{R}^d$ - –ª–∞—Ç–µ–Ω—Ç–Ω—ã–π –≤–µ–∫—Ç–æ—Ä item i.
- $s(u,i)$ - –º–æ–¥–µ–ª—å–Ω—ã–π —Å–∫–æ—Ä (score) –¥–ª—è –ø–∞—Ä—ã u,i. –ß–∞—Å—Ç–æ $s(u,i)=\mathbf{u}_u^\top\mathbf{v}_i$.
- $\lambda$ - L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è (—Å–∫–∞–ª—è—Ä).
- $\sigma(x)=\frac{1}{1+e^{-x}}$ - —Å–∏–≥–º–æ–∏–¥–∞.
   
---
    
## 2. KNN –º–µ—Ç–æ–¥—ã.  

- **–¶–µ–ª—å:** –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –æ—Ü–µ–Ω–∫—É/—Å–∫–æ—Ä $\hat r_{ui}$ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è **u** –∏ item **i** –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ—Ö–æ–∂–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–ª–∏ –ø–æ—Ö–æ–∂–∏—Ö items.  
   
---
    
### 2.1 –ö–æ—Å–∏–Ω—É—Å–Ω–∞—è —Å—Ö–æ–∂–µ—Å—Ç—å  

$$sim(u,v)=\frac{\mathbf{r}_u^\top \mathbf{r}_v}{\|\mathbf{r}_u\|\|\mathbf{r}_v\|}$$

–≥–¥–µ $\mathbf{r}_u,\mathbf{r}_v$ - –≤–µ–∫—Ç–æ—Ä—ã –æ—Ü–µ–Ω–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π u –∏ v.  
   
---
    

### 2.2. –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –ü–∏—Ä—Å–æ–Ω–∞  

$$
sim_{\mathrm{pearson}}(u,v) =
\frac{\sum_{i \in I_{uv}} (r_{ui} - \bar r_u)(r_{vi} - \bar r_v)}
{\sqrt{\sum_{i \in I_{uv}} (r_{ui} - \bar r_u)^2} \cdot \sqrt{\sum_{i \in I_{uv}} (r_{vi} - \bar r_v)^2}}
$$


**–û–±–æ–∑–Ω–∞—á–µ–Ω–∏—è:**  
- $I_{uv}$ - –º–Ω–æ–∂–µ—Å—Ç–≤–æ items, –∫–æ—Ç–æ—Ä—ã–µ –æ–±–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è **ùë¢** –∏ **ùë£** –æ—Ü–µ–Ω–∏–ª–∏. –¢–æ–ª—å–∫–æ –ø–æ –Ω–∏–º –º–æ–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é.
- $r_{ui} -\bar ùëü_ùë¢$ - –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏ ùë¢ –¥–ª—è item **ùëñ** –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ –ø–æ **ùë¢**. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è **ùë£**. 
- $\sum_{i\in I_{uv}}(r_{ui}-\bar r_u)(r_{vi}-\bar r_v)$ - —Å—É–º–º–∞—Ä–Ω–∞—è ¬´–∫–æ–æ–ø–µ—Ä–∞—Ü–∏—è¬ª –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π; –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è, –µ—Å–ª–∏ –æ–±–∞ —Å–∫–ª–æ–Ω–Ω—ã –æ—Ü–µ–Ω–∏–≤–∞—Ç—å –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ items –≤—ã—à–µ/–Ω–∏–∂–µ —Å–≤–æ–∏—Ö —Å—Ä–µ–¥–Ω–∏—Ö.
- $\sqrt{\sum (r_{ui}-\bar r_u)^2}\sqrt{\sum (r_{vi}-\bar r_v)^2}$ ‚Äî –Ω–æ—Ä–º–∏—Ä—É—é—â–∏–π –º–Ω–æ–∂–∏—Ç–µ–ª—å (–¥–ª–∏–Ω—ã —Ü–µ–Ω—Ç—Ä–æ–≤—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤), –¥–µ–ª–∞–µ—Ç –º–µ—Ç—Ä–∏–∫—É –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–π –æ—Ç —Å–∏–ª—ã –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π.

**–Ω—é–∞–Ω—Å:** 
- –ø—Ä–∏ –Ω—É–ª–µ–≤–æ–º –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª–µ –ø—Ä–∏–Ω—è—Ç–æ —Å—á–∏—Ç–∞—Ç—å –ø–æ—Ö–æ–∂–µ—Å—Ç—å —Ä–∞–≤–Ω–æ–π –Ω—É–ª—é , –ø—Ä–∏ –º–∞–ª—ã—Ö $|I_{uv}|$ –ø—Ä–∏–º–µ–Ω—è—Ç—å shrinkage:  
${sim}'=\frac{|I_{uv}|}{|I_{uv}|+\kappa}\ {sim}_{\text{pearson}}(u,v).$
- –≥–¥–µ $\kappa$ ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä (–æ–±—ã—á–Ω–æ –¥–µ—Å—è—Ç–∫–∏ ‚Äî —Å–æ—Ç–Ω–∏).
- –≤ item‚ÄëKNN –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–æ–ª—å–∫–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ—Ö–æ–∂–µ—Å—Ç–∏ (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –ª–∏–±–æ –æ–±–Ω—É–ª—è—é—Ç, –ª–∏–±–æ –æ—Ç–¥–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç).  
   
---
    
### 2.3 Adjusted Cosine   

$$sim_{{adjcos}}(i,i')=\frac{\sum_{u\in I_{ii'}} (r_{ui}-\bar r_u)\ (r_{ui'}-\bar r_u)}{\sqrt{\displaystyle\sum_{u\in I_{ii'}} (r_{ui}-\bar r_u)^2}\ \sqrt{\displaystyle\sum_{u\in I_{ii'}} (r_{ui'}-\bar r_u)^2}}.$$

- $r_{ui} -\bar ùëü_ùë¢$ - –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏ ùë¢ –¥–ª—è item ùëñ –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ –ø–æ ùë¢. –£—á–µ—Ç —Å–º–µ—â–µ–Ω–∏—è –æ—Ü–µ–Ω–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  
   
---
    
## 3. –¢–µ–∫—Å—Ç–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã —Å—Ö–æ–∂–µ—Å—Ç–∏  
### 3.1 TF-IDF (Term Frequency - Inverse Document Frequency)
- **–¶–µ–ª—å:** –æ—Ü–µ–Ω–∏—Ç—å –≤–∞–∂–Ω–æ—Å—Ç—å —Ç–µ—Ä–º–∏–Ω–∞ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –≤—Å–µ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏.
(–í —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–æ–π –∑–∞–¥–∞—á–µ —Ç–µ—Ä–º–∏–Ω—ã - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –¥–æ–∫—É–º–µ–Ω—Ç—ã - items.)
- **–§–æ—Ä–º—É–ª—ã:**

**TF (Term Frequency):**   
  
$tf(t,d) = \frac{f_{t,d}}{\sum_{t'\in d} f_{t',d}}$  
   
–≥–¥–µ $f_{t,d}$ - —á–∞—Å—Ç–æ—Ç–∞ —Ç–µ—Ä–º–∏–Ω–∞ t –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ d

**IDF (Inverse Document Frequency):**  
  
$idf(t,D) = \log\frac{N}{|{d\in D: t\in d}|}$  
    
–≥–¥–µ N - –æ–±—â–µ–µ —á–∏—Å–ª–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ D

**TF-IDF:**   
$tfidf(t,d,D) = tf(t,d) \times idf(t,D)$
  
**–í–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ:**  
–î–æ–∫—É–º–µ–Ω—Ç d –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –∫–∞–∫   

$\mathbf{d} = (tfidf(t_1,d,D), tfidf(t_2,d,D), \dots)$

**–°—Ö–æ–∂–µ—Å—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:** 
–≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –∫–æ—Å–∏–Ω—É—Å–Ω—É—é –º–µ—Ä—É –º–µ–∂–¥—É TF-IDF –≤–µ–∫—Ç–æ—Ä–∞–º–∏.  
   
---
    
### 3.2 BM25 (Best Match 25)  
**–¶–µ–ª—å**: –≤–∑–≤–µ—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è TF-IDF –¥–ª—è —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∑–∞–ø—Ä–æ—Å—É.
–†–∞–Ω–≥–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–∑ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞, –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–ª—è —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è items: —É—á–∏—Ç—ã–≤–∞–µ—Ç —á–∞—Å—Ç–æ—Ç—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∏ –¥–ª–∏–Ω—É ¬´–¥–æ–∫—É–º–µ–Ω—Ç–∞¬ª (–ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è). –í —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ –¥–æ–∫—É–º–µ–Ω—Ç, item ‚Äî –∫–∞–∫ —Ç–µ—Ä–º–∏–Ω.

**–§–æ—Ä–º—É–ª–∞:**

$BM25(q,d)=‚àë_{t‚ààq} IDF(t)‚ãÖ \frac{f_{t,d}*(k_1+1)}{f_{t,d} + k_1‚ãÖ(1‚àíb+b‚ãÖ \frac{‚à£d‚à£}{avgdl})}$
   

**–û–±–æ–∑–Ω–∞—á–µ–Ω–∏—è:**

$q$ - –∑–∞–ø—Ä–æ—Å, $d$ - –¥–æ–∫—É–º–µ–Ω—Ç

$f_{t,d}$ - —á–∞—Å—Ç–æ—Ç–∞ —Ç–µ—Ä–º–∏–Ω–∞ t –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ d

$|d|$ - –¥–ª–∏–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Ä–º–∏–Ω–æ–≤)

$avgdl$ - —Å—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏

$k_1$, $b$ - —Å–≤–æ–±–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–æ–±—ã—á–Ω–æ $k_1 \in [1.2, 2.0]$, $b = 0.75$)

$IDF(t) = \log\frac{N - n_t + 0.5}{n_t + 0.5}$ (–º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ BM25:**  

–£—á–µ—Ç –¥–ª–∏–Ω—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞: –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç TF –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å—Ä–µ–¥–Ω–µ–π –¥–ª–∏–Ω—ã

–ù–∞—Å—ã—â–µ–Ω–∏–µ TF: –ø—Ä–∏ –±–æ–ª—å—à–∏—Ö $f_{t,d}$ –≤–∫–ª–∞–¥ —Ç–µ—Ä–º–∏–Ω–∞ –∞—Å–∏–º–ø—Ç–æ—Ç–∏—á–µ—Å–∫–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω

–ë–æ–ª–µ–µ —É—Å—Ç–æ–π—á–∏–≤ –∫ –≤–∞—Ä–∏–∞—Ü–∏—è–º –¥–ª–∏–Ω—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤  

**–û–±–∞ –º–µ—Ç–æ–¥–∞ —à–∏—Ä–æ–∫–æ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –≤ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å—Ö–æ–∂–µ—Å—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –æ—Å–æ–±–µ–Ω–Ω–æ –∫–æ–≥–¥–∞ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Ä–∞–∑—Ä–µ–∂–µ–Ω—ã.**  
     
---
      
## 4. –ú–∞—Ç—Ä–∏—á–Ω–∞—è —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è  
   
---
    
### 4.1 –û–±—â–∞—è –∏–¥–µ—è  
- –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ–º –º–∞—Ç—Ä–∏—Ü—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π $R$ –∫–∞–∫ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –ª–∞—Ç–µ–Ω—Ç–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ items:
  
$R \approx U V^\top,$

–≥–¥–µ $U \in \mathbb{R}^{|U|\times d}$ ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤,  
$V \in \mathbb{R}^{|I|\times d}$ ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ —Ñ–∞–∫—Ç–æ—Ä–æ–≤ items,  
$d$ ‚Äî —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –ª–∞—Ç–µ–Ω—Ç–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞.

- –°–∫–æ—Ä –¥–ª—è –ø–∞—Ä—ã $(u,i)$:  
$s(u,i) = \mathbf{u}_u^\top \mathbf{v}_i$  
    
---
    
### 4.2 SVD (Singular Value Decomposition)    
- –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã $R$:  
$R = U \Sigma V^\top$
- –í —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è—Ö –∏—Å–ø–æ–ª—å–∑—É—é—Ç **Truncated SVD**: –æ—Å—Ç–∞–≤–ª—è—é—Ç —Ç–æ–ª—å–∫–æ $d$ –≥–ª–∞–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç.  
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã—è–≤–∏—Ç—å —Å–∫—Ä—ã—Ç—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã (–∂–∞–Ω—Ä—ã, –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è).  
   
---
   
### 4.3 ALS (Alternating Least Squares)  
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –æ—à–∏–±–∫–∏ –¥–ª—è implicit feedback –≤ –æ–±—â–µ–º –≤–∏–¥–µ:  

$\min_{U,V} \sum_{u,i} c_{ui}(p_{ui} - \mathbf{u}_u^\top \mathbf{v}_i)^2 + \lambda(\|U\|^2 + \|V\|^2),$

–≥–¥–µ $p_{ui} \in \{0,1\}$ ‚Äî –±–∏–Ω–∞—Ä–Ω—ã–π —Å–∏–≥–Ω–∞–ª,  
$c_{ui} = 1 + \alpha r_{ui}$ ‚Äî confidence weight.  

- –†–µ—à–µ–Ω–∏–µ: –ø–æ–æ—á–µ—Ä—ë–¥–Ω–æ —Ñ–∏–∫—Å–∏—Ä—É–µ–º $U$, –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º $V$, –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç.  
  
---
   
## 5. –õ–∏–Ω–µ–π–Ω—ã–µ –º–æ–¥–µ–ª–∏  
   
---
    

### 5.1 EASE (Embarrassingly Shallow Autoencoder)  
- Closed‚Äëform —Ä–µ—à–µ–Ω–∏–µ:  
$\hat R = R W$ ,
–≥–¥–µ $W$ ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ –≤–µ—Å–æ–≤, –æ–±—É—á–∞–µ–º–∞—è —á–µ—Ä–µ–∑ —Ä–µ–≥—É–ª—è—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:  

$W = (G + \lambda I)^{-1} G, \quad G = R^\top R$.

- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: $diag(W) = 0$ (–∏—Å–∫–ª—é—á–∞–µ–º —Ç—Ä–∏–≤–∏–∞–ª—å–Ω—ã–µ —Å–≤—è–∑–∏ item —Å —Å–∞–º–∏–º —Å–æ–±–æ–π).  
   
---
    
### 5.2 SLIM (Sparse Linear Methods)  
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:  
$\min_W \frac{1}{2}\|R - RW\|^2 + \lambda_1 \|W\|_1 + \lambda_2 \|W\|_2^2$,

–≥–¥–µ $W$ ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ –≤–µ—Å–æ–≤ (—Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è).  
- L1‚Äë—Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è - sparsity, L2 - —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å.  
- –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è: –∫–∞–∂–¥—ã–π item –≤—ã—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ –ª–∏–Ω–µ–π–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –¥—Ä—É–≥–∏—Ö.  
   
---
    
## 6. –ù–µ–π—Ä–æ—Å–µ—Ç–µ–≤—ã–µ –ø–æ–¥—Ö–æ–¥—ã  
   
---
    
### 6.1 NCF (Neural Collaborative Filtering)  
- –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ items —á–µ—Ä–µ–∑ –æ–±—É—á–∞–µ–º—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏:    
$\mathbf{u}_u, \mathbf{v}_i \in \mathbb{R}^d$.
- –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –∏–ª–∏ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ ‚Üí –ø–æ–¥–∞—á–∞ –≤ MLP:  
$s(u,i) = f_{\text{MLP}}([\mathbf{u}_u, \mathbf{v}_i])$.
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.  
   
---
    
### 6.2 Two‚ÄëTower –º–æ–¥–µ–ª–∏  
- –û—Ç–¥–µ–ª—å–Ω—ã–µ —ç–Ω–∫–æ–¥–µ—Ä—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ items:
       
$$
\mathbf{u}_ {u} = f_{\mathrm{user}}(u), \quad \mathbf{v}_{i} = f_{\mathrm{item}}(i)
$$

- –û–±—É—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∏–≤–Ω—ã–π –ª–æ—Å—Å (BPR, BCE).    
- –°–∫–æ—Ä:    
$$s(u,i) = \mathbf{u}_u^\top \mathbf{v}_i$$
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ cold‚Äëstart –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ items/users.  
    
---
    
## 7. –§—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å  
   
---
    
### 7.1 BPR (Bayesian Personalized Ranking)  
- –¶–µ–ª—å: –º–∞–∫—Å–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, —á—Ç–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π item –≤—ã—à–µ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–≥–æ:  

$$\mathcal{L}_{BPR} = -\sum_{(u,i,j)} \log \sigma(\mathbf{u}_u^\top \mathbf{v}_i - \mathbf{u}_u^\top \mathbf{v}_j).$$

–≥–¥–µ $i$ ‚Äî –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π item, $j$ ‚Äî –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π.  
   
---
   
### 7.2 BCE (Binary Cross‚ÄëEntropy)  
- –î–ª—è –ø–∞—Ä $(u,i)$ —Å –º–µ—Ç–∫–æ–π $y_{ui} \in \{0,1\}$:  

$$\mathcal{L}_{BCE} = -\sum_{(u,i)} \big[y_{ui}\log \sigma(s(u,i)) + (1-y_{ui})\log (1-\sigma(s(u,i)))\big].$$  
  
---
  
## 8. –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞  

- **HitRate@K:**
  - –¥–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å—Ä–µ–¥–∏ top-K —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã—Ö items, —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –æ–∫–∞–∑–∞–ª—Å—è –≤ –∏—Ö test-—Å–ø–∏—Å–∫–µ.


$$HitRate@K(u) = \max_{j \in [1..K]}\mathbb{1}_{r_{uj}}$$


$$ HitRate@K = \frac{\sum_{u=1}^{N}HitRate@K(u)}{N} $$   

$\qquad\qquad\qquad\mathbb{1}_ {r_{uj}}$ - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è —é–∑–µ—Ä–∞ u —Ñ–∏–ª—å–º–∞(item) j

- **Precision@K:**
  - –¥–æ–ª—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å—Ä–µ–¥–∏ –ø–µ—Ä–≤—ã—Ö $K$ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
  
$$Precision@K(u)=\frac{1}{K}\sum_{j=1}^{K}\mathbb{1}_{r_{uj}}$$  

$$Precision@K=\frac{1}{N}\sum_{u=1}^{N}Precision@K(u)$$  

$\qquad\qquad\qquad \mathbb{1}_ {r_{uj}}$ - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω–æ–≥–æ item‚Äë–∞ $j$ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è $u$;  
$\qquad\qquad\qquad N$ - —á–∏—Å–ª–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ.

- **Recall@K:**  
  - –¥–æ–ª—è –≤—Å–µ—Ö —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –≤ —Ç–æ–ø‚ÄëK.
  
$$Recall@K(u)=\frac{\sum_{j=1}^{K}\mathbb{1}_{r_{uj}}}{R_u}$$

$$Recall@K=\frac{1}{N}\sum_{u=1}^{N}Recall@K(u)$$

$\qquad\qquad\qquad R_u$ - —á–∏—Å–ª–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö item‚Äë–æ–≤ –≤ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è $u$.

- **NDCG@K:**  
  - Normalized Discounted Cumulative Gain; —É—á–∏—Ç—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –∏ –≥—Ä–∞–¥—É–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä —Ä–µ–π—Ç–∏–Ω–≥).

$$IDCG@K(u)=\max_{\text{perm}}\; DCG@K(u)\quad\text{(DCG –ª—É—á—à–µ–≥–æ —É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞–Ω–∏—è)}$$

$$NDCG@K(u)=\frac{DCG@K(u)}{IDCG@K(u)}$$

$$NDCG@K=\frac{1}{N}\sum_{u=1}^{N}NDCG@K(u)$$

$\qquad\qquad\qquad rel_{uj}$ - —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å item‚Äë–∞ $j$ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è $u$ (–≥—Ä–∞–¥—É–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–ª–∏ –±–∏–Ω–∞—Ä–Ω–∞—è).

- **MAP@K:**  
  - Mean Average Precision at K; —É—Å—Ä–µ–¥–Ω—ë–Ω–Ω–æ–µ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∑–Ω–∞—á–µ–Ω–∏–µ Average Precision@K.

$$AP@K(u)=\frac{1}{\min(R_u,K)}\sum_{j=1}^{K}Precision@j(u)\cdot \mathbb{1}_{r_{uj}}$$

$$MAP@K=\frac{1}{N}\sum_{u=1}^{N}AP@K(u)$$

$\qquad\qquad\qquad Precision@j(u)$ - precision –¥–ª—è –ø–µ—Ä–≤—ã—Ö $j$ –ø–æ–∑–∏—Ü–∏–π —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è $u$;    
$\qquad\qquad\qquad R_u$ - —á–∏—Å–ª–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö item‚Äë–æ–≤ –≤ —Ç–µ—Å—Ç–µ –¥–ª—è $u$.

- **Coverage@K:**  
  - –∏–∑–º–µ—Ä—è–µ—Ç –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã —Å–∏—Å—Ç–µ–º–∞ —Å–ø–æ—Å–æ–±–Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å. –û–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫—É—é –¥–æ–ª—é –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤ (–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π) —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–∞–ª—å–Ω–æ –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤ —Å–≤–æ–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è—Ö.
   
$$Coverage@K=\frac{\left|\bigcup\limits_{u\in U} y_u\right|}{|I|}$$

$\qquad\qquad\qquad ùëà$ - –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ

$\qquad\qquad\qquad y_u$  - –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã—Ö item'–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–æ–ø‚ÄëK) –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ùë¢

$\qquad\qquad\qquad ùêº$ - –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤—Å–µ—Ö —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö item-–æ–≤ –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ    
    
---
   
## 9. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ 
–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ: 
- –ú–µ—Ç—Ä–∏–∫–∏ —Å—Ö–æ–∂–µ—Å—Ç–∏ (cosine, Pearson, adjusted cosine).  
- –¢–µ–∫—Å—Ç–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã (TF‚ÄëIDF, BM25).  
- –ú–∞—Ç—Ä–∏—á–Ω–∞—è —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (SVD, ALS).  
- –õ–∏–Ω–µ–π–Ω—ã–µ –º–æ–¥–µ–ª–∏ (EASE, SLIM).  
- –ù–µ–π—Ä–æ—Å–µ—Ç–µ–≤—ã–µ –ø–æ–¥—Ö–æ–¥—ã (NCF, Two‚ÄëTower).  
- –§—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å (BPR, BCE).  
- –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (HitRate, Precision, Recall, NDCG, MAP, Coverage).  

–≠—Ç–∏ —Ñ–æ—Ä–º—É–ª—ã —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç –æ—Å–Ω–æ–≤—É —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º.


